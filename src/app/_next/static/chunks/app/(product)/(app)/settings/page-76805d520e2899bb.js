(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3555],{73001:function(e,t,i){Promise.resolve().then(i.bind(i,64732))},36084:function(e,t,i){"use strict";i.d(t,{I7:function(){return _},b4:function(){return r},at:function(){return g}});var n=i(9753),s=i(98639),a=i.t(s,2),o=i(3084);let r=e=>{let{children:t,title:i,className:a}=e,{setTitleElement:r,setTitle:l}=(0,s.useContext)(o.pI),c=(0,s.useRef)(null);return(0,s.useEffect)(()=>{(null==c?void 0:c.current)&&r(c),i&&l(i)},[c,i,r,l]),(0,s.useEffect)(()=>()=>{l("")},[l]),(0,n.jsx)("div",{ref:c,className:a,children:t})};var l=i(9544),c={810:e=>{e.exports=a}},d={},u={};(()=>{Object.defineProperty(u,"__esModule",{value:!0}),u.useScroll=void 0;let e=function e(t){var i=d[t];if(void 0!==i)return i.exports;var n=d[t]={exports:{}};return c[t](n,n.exports,e),n.exports}(810);u.useScroll=t=>{(0,e.useEffect)(()=>{let e={capture:!0,passive:!0};return window.addEventListener("scroll",t,e),()=>{window.removeEventListener("scroll",t,e)}},[t])}})(),u.__esModule;var p=u.useScroll,h=i(34152);let m=e=>{let{element:t,scrollTop:i,isMobile:n}=e,s=.4*t.clientHeight;return i+(n?56:72)>=t.offsetTop+s},_=(0,l.Pi)(e=>{let{children:t,scrollElement:i,outerTitle:a="",headerElement:r,headerThreshold:l}=e,[c,d]=(0,s.useState)(a),[u,_]=(0,s.useState)(null),[g,v]=(0,s.useState)(!1),[f,x]=(0,s.useState)(!1),{settings:C}=(0,h.oR4)(),y=C.layout===h.t8m.Mobile;(0,s.useLayoutEffect)(()=>{d(a)},[a]);let E=(0,s.useCallback)(()=>{if(!i)return;let e=null!=l?l:10,t=r?Number(r.offsetTop)-e:e;t<0&&(t=0),x(i.scrollTop>t),(null==u?void 0:u.current)&&v(m({element:null==u?void 0:u.current,scrollTop:i.scrollTop,isMobile:y}))},[i,l,r,u,y]);(0,s.useEffect)(()=>{i&&(null==i?void 0:i.scrollTop)!==0||x(!1)},[i,null==i?void 0:i.scrollTop]),p(E);let I=(0,s.useMemo)(()=>({title:c,setTitle:d,titleElement:u,scrollElement:i,setTitleElement:_,isScrolledTitle:g,isScrolling:f}),[c,g,u,i,f]);return(0,n.jsx)(o.pI.Provider,{value:I,children:t})});i(66414);let g=(e,t)=>((0,h.uK4)().get(h.Xt8),[(0,s.useMemo)(()=>{if(void 0!==t){let i=t-17;return{"--average-color-background":e,transform:"translateY(".concat(t>=17?0:i,"px)"),opacity:1}}return{}},[t,!1,e]),(0,s.useMemo)(()=>({"--average-color-background":e}),[e])])},64732:function(e,t,i){"use strict";i.d(t,{SettingsPage:function(){return O}});var n=i(9753),s=i(9544),a=i(80542),o=i(31014),r=i(23881),l=i(41055),c=i(2570),d=i(98639),u=i(45028),p=i(34152);let h=()=>{let e=(0,p.uK4)().get(p.U5t),t=(0,p.yyu)(e.oldWebHost),{language:i}=(0,p.ZSk)();return"https://".concat(t,"/newimport?lang=").concat(i)};var m=i(89352),_=i(3084),g=i(62946),v=i.n(g);let f=(0,s.Pi)(()=>{let{formatMessage:e}=(0,a.Z)(),{location:t,modals:{aboutAppModal:i}}=(0,p.oR4)(),s=(0,p.bop)(),r=(0,p.aMu)(),{language:l}=(0,p.ZSk)();return(0,n.jsxs)(m.u,{className:v().root,headerClassName:v().modalHeader,contentClassName:v().modalContent,title:e({id:"settings.about-app"}),open:i.isOpened,onOpenChange:i.onOpenChange,onClose:i.close,size:"fitContent",placement:"center",labelClose:e({id:"interface-actions.close"}),children:[(0,n.jsxs)("ul",{className:v().list,children:[(0,n.jsx)("li",{className:v().item,children:(0,n.jsx)(_.rU,{className:v().link,target:"_blank",href:"https://yandex.".concat(t.tld,"/support/music/performers-and-copyright-holders.html?lang=").concat(l),children:(0,n.jsx)(c.Caption,{type:"controls",variant:"span",size:"l",weight:"medium",children:(0,n.jsx)(o.Z,{id:"footer.links-copyright-holders"})})})}),(0,n.jsx)("li",{className:v().item,children:(0,n.jsx)(_.rU,{className:v().link,target:"_blank",href:"https://yandex.".concat(t.tld,"/legal/music_mobile_agreement?lang=").concat(l),children:(0,n.jsx)(c.Caption,{type:"controls",variant:"span",size:"l",weight:"medium",children:(0,n.jsx)(o.Z,{id:"footer.links-terms"})})})}),(0,n.jsx)("li",{className:v().item,children:(0,n.jsx)(_.rU,{className:v().link,target:"_blank",href:"https://music.yandex.".concat(t.tld,"/legal/recommendations/ru/#music?lang=").concat(l),children:(0,n.jsx)(c.Caption,{type:"controls",variant:"span",size:"l",weight:"medium",children:(0,n.jsx)(o.Z,{id:"footer.links-recommendation-rules"})})})}),(0,n.jsx)("li",{className:v().item,children:(0,n.jsx)(_.rU,{className:v().link,target:"_blank",href:"https://yandex.".concat(t.tld,"/support/music/index.html?lang=").concat(l),children:(0,n.jsx)(c.Caption,{type:"controls",variant:"span",size:"l",weight:"medium",children:(0,n.jsx)(o.Z,{id:"footer.links-help"})})})})]}),(0,n.jsx)(c.Caption,{className:v().explicitText,type:"controls",variant:"div",size:"xs",weight:"medium",dangerouslySetInnerHTML:{__html:e({id:"about-app.explicit-content"})}}),(0,n.jsx)(c.Caption,{className:v().companyText,type:"controls",variant:"div",size:"xs",children:(0,n.jsx)(o.Z,{id:"about-app.app-name"})}),(0,n.jsx)(c.Caption,{className:v().versionText,type:"controls",variant:"div",size:"xs",children:e({id:"desktop.app-version-short"},{version:s})}),(0,n.jsx)(c.Caption,{className:v().versionText,type:"controls",variant:"div",size:"xs",children:e({id:"desktop.app-revision"},{revision:r})})]})});var x=i(60836),C=i(39513),y=i(28852),E=i(40114),I=i.n(E);let b=e=>{let{title:t,description:i,onClick:s,descriptionProps:a,...o}=e;return(0,n.jsx)(C.z,{className:(0,x.W)(I().root,I().important),iconContainerClassName:I().iconContainer,icon:(0,n.jsx)(y.J,{className:I().icon,size:"xs",variant:"arrowRight"}),iconPosition:"right",onClick:s,isBlock:!0,withRipple:!1,withHover:!1,variant:"text",size:"xs",...o,children:(0,n.jsxs)("div",{className:I().content,children:[(0,n.jsx)(c.Caption,{className:I().title,variant:"div",size:"l",weight:"bold",lineClamp:1,children:t}),i&&(0,n.jsx)(c.Caption,{variant:"div",type:"text",size:"xs",weight:"medium",className:I().description,...a,children:i})]})})};var w=i(72433),S=i.n(w);let N=e=>{let{link:t,title:i,description:s,target:a}=e;return(0,n.jsxs)(_.rU,{className:S().root,containerClassName:S().container,textClassName:S().linkText,icon:(0,n.jsx)(y.J,{className:S().icon,size:"xs",variant:"arrowRight"}),iconPosition:"right",href:t,...a?{target:a}:{},children:[(0,n.jsx)(c.Caption,{className:S().title,variant:"div",size:"l",weight:"bold",lineClamp:1,children:i}),s&&(0,n.jsx)(c.Caption,{variant:"div",type:"text",size:"xs",weight:"medium",className:S().description,children:s})]})};var P=i(10951),j=i.n(P);let k=(0,s.Pi)(()=>{let{modals:{shortcutsModal:e}}=(0,p.oR4)(),{formatMessage:t}=(0,a.Z)(),i=(0,d.useMemo)(()=>{let e=(0,n.jsx)(c.Caption,{className:j().text,variant:"div",type:"text",size:"xs",weight:"normal",children:(0,n.jsx)(o.Z,{id:"shortcuts.or"})},"or");return p.ed$.map(t=>{let{shortcutsAction:i,formattedMessage:s}=t,a=p.ftz[i].map((e,t)=>(0,n.jsx)("div",{className:j().button,children:(0,n.jsx)(c.Caption,{variant:"div",type:"text",size:"xs",weight:"normal",children:e})},t));return a.length>1&&a.splice(1,0,e),(0,n.jsx)("li",{children:(0,n.jsxs)("div",{className:j().content,children:[(0,n.jsx)(c.Caption,{className:j().text,variant:"div",type:"text",size:"xs",weight:"normal",children:s}),(0,n.jsx)("div",{className:j().buttons,children:a})]})},i)})},[]);return(0,n.jsx)(m.u,{className:j().root,headerClassName:j().modalHeader,contentClassName:j().modalContent,title:t({id:"settings.shortcuts"}),open:e.isOpened,onOpenChange:e.onOpenChange,onClose:e.close,size:"fitContent",placement:"center",labelClose:t({id:"interface-actions.close"}),children:(0,n.jsx)("ul",{className:j().list,children:i})})});var A=i(4343),T=i.n(A);let q=(0,s.Pi)(()=>{let e=(0,p.bop)(),{modals:{shortcutsModal:t,aboutAppModal:i},equalizer:s,experiments:o,wizard:l}=(0,p.oR4)(),{formatMessage:c}=(0,a.Z)(),m=(0,p.jpI)(),_=(0,p.XNW)(),g=h(),v=o.checkExperiment(p.peG.WebNextEqualizer,"on")&&(null==m?void 0:m.equalizer),x=s.isEnabled?c({id:"equalizer.enabled"}):c({id:"equalizer.disabled"}),C=(0,d.useMemo)(()=>c({id:"desktop.app-version-short"},{version:e}),[!0,c,e]),y=(0,d.useMemo)(()=>o.checkExperiment(p.peG.WebNextWizard,"on")?(0,n.jsx)(b,{title:c({id:"settings.preferences"}),description:c({id:"settings.preferences-description"}),onClick:l.modal.open}):(0,n.jsx)(N,{title:c({id:"settings.preferences"}),description:c({id:"settings.preferences-description"}),link:_,target:"_self"}),[o,c,l,_,!0]);return(0,n.jsxs)("ul",{className:T().root,...(0,r.BA)(r.QM.settings.SETTINGS_LIST),children:[(0,n.jsx)("li",{className:T().item,children:y}),v&&(0,n.jsxs)("li",{className:T().item,children:[(0,n.jsx)(b,{title:c({id:"equalizer.title"}),description:x,onClick:s.modal.open,descriptionProps:(0,r.BA)(r.QM.settings.SETTINGS_EQUALIZER_BUTTON_DESCRIPTION),...(0,r.BA)(r.QM.settings.SETTINGS_EQUALIZER_BUTTON)}),(0,n.jsx)(u.Qk,{})]}),(0,n.jsx)("li",{className:T().item,children:(0,n.jsx)(N,{title:c({id:"settings.import-media"}),description:c({id:"settings.import-media-description"}),link:g})}),(0,n.jsxs)("li",{className:T().item,children:[(0,n.jsx)(b,{title:c({id:"settings.shortcuts"}),onClick:t.open}),(0,n.jsx)(k,{})]}),C&&(0,n.jsxs)("li",{className:T().item,children:[(0,n.jsx)(b,{title:c({id:"settings.about-app"}),description:C,onClick:i.open}),(0,n.jsx)(f,{})]})]})});var M=i(36084),L=i(66995),R=i.n(L);let O=(0,s.Pi)(()=>{let{formatMessage:e}=(0,a.Z)(),[t,i]=(0,p.zU3)(),s=(0,p.k67)();return(0,n.jsxs)(M.I7,{scrollElement:t,outerTitle:e({id:"page.settings"}),children:[(0,n.jsx)(_.h4,{variant:"text",withForwardControl:!1,withBackwardControl:s.canBack,children:(0,n.jsx)(c.Heading,{variant:"h2",weight:"bold",size:"xl",lineClamp:1,children:(0,n.jsx)(o.Z,{id:"page.settings"})})}),(0,n.jsx)(l.t,{ref:i,className:R().root,containerClassName:R().scrollableContainer,...(0,r.BA)(r.Br.settings.SETTINGS_PAGE),children:(0,n.jsxs)("div",{className:R().container,children:[(0,n.jsx)("div",{className:R().content,children:(0,n.jsx)(q,{})}),(0,n.jsx)(_.$_,{className:R().footer})]})})]})})},66995:function(e){e.exports={root:"SettingsPage_root__BB4lC",scrollableContainer:"SettingsPage_scrollableContainer__qD32i",container:"SettingsPage_container__bIwea",content:"SettingsPage_content__cR6Ra",footer:"SettingsPage_footer__QIqyx"}},62946:function(e){e.exports={root:"AboutAppModal_root__yBvgU",modalHeader:"AboutAppModal_modalHeader__q1NPj",modalContent:"AboutAppModal_modalContent__SHO_X",list:"AboutAppModal_list__HfB82",link:"AboutAppModal_link__i3P3P",explicitText:"AboutAppModal_explicitText__29HUD",companyText:"AboutAppModal_companyText__yroW0",versionText:"AboutAppModal_versionText__iFb8L"}},4343:function(e){e.exports={root:"Settings_root__FVVrn",item:"Settings_item__Ksa9h"}},40114:function(e){e.exports={icon:"SettingsListButtonItem_icon__WULZ1",root:"SettingsListButtonItem_root__3dtV2",important:"SettingsListButtonItem_important__AcEon",iconContainer:"SettingsListButtonItem_iconContainer__KECtv",content:"SettingsListButtonItem_content___Opuo",title:"SettingsListButtonItem_title__npCza",description:"SettingsListButtonItem_description__g8_Ba"}},72433:function(e){e.exports={icon:"SettingsListLinkItem_icon__p4P_V",root:"SettingsListLinkItem_root__rTPC9",container:"SettingsListLinkItem_container__k7bhS",linkText:"SettingsListLinkItem_linkText__0PHlQ",title:"SettingsListLinkItem_title__duJnL",description:"SettingsListLinkItem_description__xWeAD"}},10951:function(e){e.exports={root:"ShortcutsModal_root__ro7m4",modalHeader:"ShortcutsModal_modalHeader__IYJ9m",modalContent:"ShortcutsModal_modalContent__SCpYX",list:"ShortcutsModal_list__eS4ox",text:"ShortcutsModal_text__5JJ0j",content:"ShortcutsModal_content__Li9Ip",buttons:"ShortcutsModal_buttons__o_xlC",button:"ShortcutsModal_button__cTIee"}},76894:function(e,t,i){"use strict";i.d(t,{Tb:function(){return _},gE:function(){return o},Pg:function(){return m},nJ:function(){return r},sd:function(){return w},$J:function(){return N},Ez:function(){return k}});var n,s,a,o,r,l,c=i(8655),d=i(40193);async function u(e){let{secretKey:t,data:i}=e,n=new TextEncoder,s=n.encode(t);return crypto.subtle.importKey("raw",s,{name:"HMAC",hash:{name:"SHA-256"}},!0,["sign","verify"]).then(async e=>{let t=n.encode(i);return crypto.subtle.sign("HMAC",e,t).then(e=>btoa(String.fromCharCode(...new Uint8Array(e))).slice(0,-1))})}function p(){return Math.floor(Date.now()/1e3)}var h=i(37810);class m extends h.y{constructor(e,{code:t="E_MEDIA_PROVIDER",...i}={}){super(e,{code:t,...i}),(0,c._)(this,"name","MediaProviderException"),Object.setPrototypeOf(this,m.prototype)}}class _ extends m{constructor(e,{code:t="E_DOWNLOADINFO_MEDIA_PROVIDER",...i}={}){super(e,{code:t,...i}),(0,c._)(this,"name","DownloadInfoMediaProviderException"),Object.setPrototypeOf(this,_.prototype)}}let g={lossless:[{codec:d.V9.FLAC,bitrateInKbps:0}],hq:[{codec:d.V9.MP3,bitrateInKbps:320}],nq:[{codec:d.V9.AAC,bitrateInKbps:128},{codec:d.V9.MP3,bitrateInKbps:192}],lq:[{codec:d.V9.AAC,bitrateInKbps:128},{codec:d.V9.MP3,bitrateInKbps:192}],preview:[{codec:d.V9.MP3,bitrateInKbps:128}],smart_preview:[{codec:d.V9.MP3,bitrateInKbps:128}]};function v(e){return e instanceof Error?{name:e.name,message:e.message,stack:e.stack,cause:e.cause}:{data:e}}(n=o||(o={})).E_GET_MEDIA_SRC="E_GET_MEDIA_SRC",n.E_CREATE_SIGN="E_CREATE_SIGN",n.E_UNSUITABLE_ENTITY_TYPE="E_UNSUITABLE_ENTITY_TYPE";class f{getMediaSource(e){return new Promise((t,i)=>{let{entity:{data:{meta:{id:n}}}}=e,s=p();u({secretKey:this.secretKey,data:"".concat(s).concat(n)}).then(e=>{this.resource.getStorageData({trackId:String(n),sign:e,tsInSeconds:s,canUseStreaming:!1,direct:!1,requireMp3Link:!1,isAliceRequester:!1,preview:this.mediaConfigController.qualityConfig.preview.value}).then(e=>{let s=function(e,t){if(t.preview.value&&e[0])return e[0];let i=e.find(e=>g.lossless.find(t=>e.codec===t.codec)),n=e.find(e=>g.hq.find(t=>e.codec===t.codec&&e.bitrateInKbps===t.bitrateInKbps)),s=e.find(e=>g.nq.find(t=>e.codec===t.codec&&e.bitrateInKbps===t.bitrateInKbps));return t.lossless.value&&i?i:t.hq.value&&n?n:(t.lq.value||t.nq.value)&&s?s:null}(e,this.mediaConfigController.qualityConfig);null!==s?this.resource.getSrcData({storageUrl:s.downloadInfoUrl}).then(e=>{try{let i=function(e){let{srcData:t,secretKey:i,trackId:n}=e,s=function(e,t){let i,n,s,a,o,r,l,c,d;let u=String.fromCharCode;function p(e,t){return e<<t|e>>>32-t}function h(e,t){let i,n,s,a,o;return(s=2147483648&e,a=2147483648&t,i=1073741824&e,n=1073741824&t,o=(1073741823&e)+(1073741823&t),i&n)?2147483648^o^s^a:i|n?1073741824&o?3221225472^o^s^a:1073741824^o^s^a:o^s^a}function m(e,t,i,n,s,a,o){return e=h(e,h(h(t&i|~t&n,s),o)),h(p(e,a),t)}function _(e,t,i,n,s,a,o){return e=h(e,h(h(t&n|i&~n,s),o)),h(p(e,a),t)}function g(e,t,i,n,s,a,o){return e=h(e,h(h(t^i^n,s),o)),h(p(e,a),t)}function v(e,t,i,n,s,a,o){return e=h(e,h(h(i^(t|~n),s),o)),h(p(e,a),t)}function f(e){let t="",i="",n,s;for(s=0;s<=3;s++)n=e>>>8*s&255,t+=(i="0".concat(n.toString(16))).substr(i.length-2,2);return t}let x=[];for(i=0,x=function(e){let t;let i=e.length,n=i+8,s=((n-n%64)/64+1)*16,a=Array(s-1),o=0,r=0;for(;r<i;)t=(r-r%4)/4,o=r%4*8,a[t]=a[t]|e.charCodeAt(r)<<o,r++;return t=(r-r%4)/4,o=r%4*8,a[t]=a[t]|128<<o,a[s-2]=i<<3,a[s-1]=i>>>29,a}(e=function(e){e=t+e.replace(/\r\n/g,"\n");let i="";for(let t=0;t<e.length;t++){let n=e.charCodeAt(t);n<128?i+=u(n):n>127&&n<2048?i+=u(n>>6|192)+u(63&n|128):i+=u(n>>12|224)+u(n>>6&63|128)+u(63&n|128)}return i}(e)),r=1732584193,l=4023233417,c=2562383102,d=271733878;i<x.length;i+=16)n=r,s=l,a=c,o=d,r=m(r,l,c,d,x[i+0],7,3614090360),d=m(d,r,l,c,x[i+1],12,3905402710),c=m(c,d,r,l,x[i+2],17,606105819),l=m(l,c,d,r,x[i+3],22,3250441966),r=m(r,l,c,d,x[i+4],7,4118548399),d=m(d,r,l,c,x[i+5],12,1200080426),c=m(c,d,r,l,x[i+6],17,2821735955),l=m(l,c,d,r,x[i+7],22,4249261313),r=m(r,l,c,d,x[i+8],7,1770035416),d=m(d,r,l,c,x[i+9],12,2336552879),c=m(c,d,r,l,x[i+10],17,4294925233),l=m(l,c,d,r,x[i+11],22,2304563134),r=m(r,l,c,d,x[i+12],7,1804603682),d=m(d,r,l,c,x[i+13],12,4254626195),c=m(c,d,r,l,x[i+14],17,2792965006),l=m(l,c,d,r,x[i+15],22,1236535329),r=_(r,l,c,d,x[i+1],5,4129170786),d=_(d,r,l,c,x[i+6],9,3225465664),c=_(c,d,r,l,x[i+11],14,643717713),l=_(l,c,d,r,x[i+0],20,3921069994),r=_(r,l,c,d,x[i+5],5,3593408605),d=_(d,r,l,c,x[i+10],9,38016083),c=_(c,d,r,l,x[i+15],14,3634488961),l=_(l,c,d,r,x[i+4],20,3889429448),r=_(r,l,c,d,x[i+9],5,568446438),d=_(d,r,l,c,x[i+14],9,3275163606),c=_(c,d,r,l,x[i+3],14,4107603335),l=_(l,c,d,r,x[i+8],20,1163531501),r=_(r,l,c,d,x[i+13],5,2850285829),d=_(d,r,l,c,x[i+2],9,4243563512),c=_(c,d,r,l,x[i+7],14,1735328473),l=_(l,c,d,r,x[i+12],20,2368359562),r=g(r,l,c,d,x[i+5],4,4294588738),d=g(d,r,l,c,x[i+8],11,2272392833),c=g(c,d,r,l,x[i+11],16,1839030562),l=g(l,c,d,r,x[i+14],23,4259657740),r=g(r,l,c,d,x[i+1],4,2763975236),d=g(d,r,l,c,x[i+4],11,1272893353),c=g(c,d,r,l,x[i+7],16,4139469664),l=g(l,c,d,r,x[i+10],23,3200236656),r=g(r,l,c,d,x[i+13],4,681279174),d=g(d,r,l,c,x[i+0],11,3936430074),c=g(c,d,r,l,x[i+3],16,3572445317),l=g(l,c,d,r,x[i+6],23,76029189),r=g(r,l,c,d,x[i+9],4,3654602809),d=g(d,r,l,c,x[i+12],11,3873151461),c=g(c,d,r,l,x[i+15],16,530742520),l=g(l,c,d,r,x[i+2],23,3299628645),r=v(r,l,c,d,x[i+0],6,4096336452),d=v(d,r,l,c,x[i+7],10,1126891415),c=v(c,d,r,l,x[i+14],15,2878612391),l=v(l,c,d,r,x[i+5],21,4237533241),r=v(r,l,c,d,x[i+12],6,1700485571),d=v(d,r,l,c,x[i+3],10,2399980690),c=v(c,d,r,l,x[i+10],15,4293915773),l=v(l,c,d,r,x[i+1],21,2240044497),r=v(r,l,c,d,x[i+8],6,1873313359),d=v(d,r,l,c,x[i+15],10,4264355552),c=v(c,d,r,l,x[i+6],15,2734768916),l=v(l,c,d,r,x[i+13],21,1309151649),r=v(r,l,c,d,x[i+4],6,4149444226),d=v(d,r,l,c,x[i+11],10,3174756917),c=v(c,d,r,l,x[i+2],15,718787259),l=v(l,c,d,r,x[i+9],21,3951481745),r=h(r,n),l=h(l,s),c=h(c,a),d=h(d,o);return(f(r)+f(l)+f(c)+f(d)).toLowerCase()}(t.path.substr(1)+t.s,i),a="/get-mp3/".concat(s,"/").concat(t.ts).concat(t.path,"?track-id=").concat(n,"&play=false");return"https://".concat(t.host).concat(a)}({trackId:n,srcData:e,secretKey:this.secretKey});t(i)}catch(e){i(new _("Failed to create src link",{code:o.E_GET_MEDIA_SRC,cause:e,data:{trackId:n,causeAsObject:v(e)}}))}}).catch(e=>{i(new _("Failed to get src data",{code:o.E_GET_MEDIA_SRC,cause:e,data:{trackId:n,causeAsObject:v(e)}}))}):i(new _("No storage url for entity",{code:o.E_GET_MEDIA_SRC}))}).catch(e=>{i(new _("Failed to get storage data",{code:o.E_GET_MEDIA_SRC,cause:e,data:{trackId:n,causeAsObject:v(e)}}))})}).catch(e=>{i(new _("Failed to create sign",{code:o.E_CREATE_SIGN,cause:e,data:{trackId:n,causeAsObject:v(e)}}))})})}constructor(e){(0,c._)(this,"secretKey",void 0),(0,c._)(this,"resource",void 0),(0,c._)(this,"mediaConfigController",void 0);let{httpClient:t,resourceConfig:i,secretKey:n,mediaConfigController:s}=e;this.resource=new d.HZ(t,{params:i.params,gateway:i.gateway,overembed:i.overembed,externalDomain:i.externalDomain,retryPolicyConfig:i.retryPolicyConfig,timeouts:i.timeouts}),this.mediaConfigController=s,this.secretKey=n}}var x=i(63665);(s=r||(r={})).HQ_PLUS="hqPlus",s.HQ="hq",s.NQ="nq",s.LQ="lq",s.PREVIEW="preview";class C extends m{constructor(e,{code:t="E_GET_FILE_INFO_MEDIA_PROVIDER",...i}={}){super(e,{code:t,...i}),(0,c._)(this,"name","GetFileInfoMediaProviderException"),Object.setPrototypeOf(this,C.prototype)}}let y=[d.V9.FLAC,d.V9.AAC,d.V9.HEAAC,d.V9.MP3];class E{getMediaSource(e){let t=p(),i=function(e,t,i){if((0,x.YM)(t))return d.nJ.SMART_PREVIEW;let n=i?d.nJ.LQ:d.nJ.NQ;switch(e){case r.HQ_PLUS:n=d.nJ.LOSSLESS;break;case r.HQ:n=i?d.nJ.NQ:d.nJ.HQ;break;case r.NQ:case r.LQ:n=i?d.nJ.LQ:d.nJ.NQ;break;case r.PREVIEW:n=d.nJ.PREVIEW}return n}(this.mediaConfigController.quality.value,e.entity,this.variables.useNewCorrespondenceBetweenQualityParams),n=y.join(""),s="".concat(t).concat(e.entity.data.meta.id).concat(i).concat(n).concat(this.transport);return new Promise((a,r)=>{u({data:s,secretKey:this.secretKey}).then(s=>this.resource.getFileInfo({tsInSeconds:t,trackId:e.entity.data.meta.id,quality:i,codecs:y,transports:[this.transport],sign:s}).then(t=>{var s;(null===(s=t.downloadInfo.urls)||void 0===s?void 0:s[0])?(e.entity.mediaSource=t,a(t.downloadInfo.urls[0])):r(new C("Empty urls in get-file-info response",{code:o.E_GET_MEDIA_SRC,data:{trackId:e.entity.data.meta.id,quality:i,codecs:n,mediaSource:t}}))}).catch(t=>{r(new C("Error in get-file-info request",{code:o.E_GET_MEDIA_SRC,cause:t,data:{trackId:e.entity.data.meta.id,quality:i,codecs:n,causeAsObject:v(t)}}))})).catch(t=>{r(new C("Error in creating sign for get-file-info request",{code:o.E_CREATE_SIGN,cause:t,data:{trackId:e.entity.data.meta.id,quality:i,codecs:n,causeAsObject:v(t)}}))})})}constructor(e){(0,c._)(this,"secretKey",void 0),(0,c._)(this,"resource",void 0),(0,c._)(this,"mediaConfigController",void 0),(0,c._)(this,"transport",void 0),(0,c._)(this,"variables",void 0);let{httpClient:t,resourceConfig:i,secretKey:n,mediaConfigController:s,transport:a,variables:o}=e;this.resource=new d.dF(t,{params:i.params,gateway:i.gateway}),this.secretKey=n,this.mediaConfigController=s,this.transport=a,this.variables=o}}class I extends h.y{constructor(e,{code:t="E_YAMUSIC_ENTITY_PROVIDER",...i}={}){super(e,{code:t,...i}),(0,c._)(this,"name","YaMusicEntityProviderException"),Object.setPrototypeOf(this,I.prototype)}}var b=i(84338);class w{async loadEntities(e){let t=e.map(e=>{let{context:t,entity:i}=e;return(0,b.m3)(t)?"".concat(i.data.meta.id,":").concat(t.data.meta.id):(0,b.KT)(t)&&"albumId"in i.data.meta&&i.data.meta.albumId?"".concat(i.data.meta.id,":").concat(i.data.meta.albumId):i.data.meta.id});return this.resource.getTracksMeta({trackIds:t,withProgress:!0}).then(e=>{let t=[];for(let i of e)t.push({type:x.A4.Unknown,meta:i});return t}).catch(e=>{throw new I("Failed to get entities meta",{cause:v(e)})})}constructor(e){(0,c._)(this,"resource",void 0);let{httpClient:t,config:i}=e;this.resource=new d.HZ(t,{params:i.params,gateway:i.gateway,retryPolicyConfig:i.retryPolicyConfig,timeouts:i.timeouts})}}var S=i(80789);class N{setQuality(e){switch(e){case r.HQ_PLUS:this.qualityConfig.lossless.value=!0,this.qualityConfig.hq.value=!0,this.qualityConfig.nq.value=!0,this.qualityConfig.lq.value=!0,this.qualityConfig.preview.value=!1,this.quality.value=r.HQ_PLUS;break;case r.HQ:this.qualityConfig.lossless.value=!1,this.qualityConfig.hq.value=!0,this.qualityConfig.nq.value=!0,this.qualityConfig.lq.value=!0,this.qualityConfig.preview.value=!1,this.quality.value=r.HQ;break;case r.NQ:case r.LQ:this.qualityConfig.lossless.value=!1,this.qualityConfig.hq.value=!1,this.qualityConfig.nq.value=!0,this.qualityConfig.lq.value=!0,this.qualityConfig.preview.value=!1,this.quality.value=r.NQ;break;case r.PREVIEW:this.qualityConfig.lossless.value=!1,this.qualityConfig.hq.value=!1,this.qualityConfig.nq.value=!1,this.qualityConfig.lq.value=!1,this.qualityConfig.preview.value=!0,this.quality.value=r.PREVIEW}}constructor(e){(0,c._)(this,"qualityConfig",{lossless:new S.wi(!1),hq:new S.wi(!0),nq:new S.wi(!0),lq:new S.wi(!0),preview:new S.wi(!0),smart_preview:new S.wi(!1)}),(0,c._)(this,"quality",new S.wi(r.HQ)),this.setQuality(e)}}(a=l||(l={})).DOWNLOAD_INFO_PROVIDER="downloadInfoProvider",a.GET_FILE_INFO_PROVIDER="getFileInfoProvider";class P extends m{constructor(e,{code:t="E_GENERATIVE_MEDIA_PROVIDER",...i}={}){super(e,{code:t,...i}),(0,c._)(this,"name","GenerativeMediaProviderException"),Object.setPrototypeOf(this,P.prototype)}}class j{async getMediaSource(e){return(0,x.OX)(e.entity)?this.getGenerativeSrc(e.entity.data):new Promise((e,t)=>{t(new P("Provided entity is not generative entity",{code:o.E_UNSUITABLE_ENTITY_TYPE}))})}async getGenerativeSrc(e){return new Promise((t,i)=>{var n;(null===(n=e.meta.stream)||void 0===n?void 0:n.url)?t(e.meta.stream.url):i(new P("Failed to create generative src link",{code:o.E_GET_MEDIA_SRC}))})}}class k{async getMediaSource(e){return(0,x.OX)(e.entity)?this.generativeProvider.getMediaSource(e):(this.variables.switchToStrmWithoutEncrypt?this.getFileInfoProvider:this.downloadInfoProvider).getMediaSource(e)}constructor(e){(0,c._)(this,"generativeProvider",new j),(0,c._)(this,"downloadInfoProvider",void 0),(0,c._)(this,"getFileInfoProvider",void 0),(0,c._)(this,"variables",void 0),this.variables=e.variables||{},this.downloadInfoProvider=new f(e.downloadInfoProviderParams),this.getFileInfoProvider=new E(e.getFileInfoProviderParams)}}}},function(e){e.O(0,[1899,6792,3580,2498,7873,2183,567,5962,4152,3084,6356,1055,9352,5028,2171,361,1744],function(){return e(e.s=73001)}),_N_E=e.O()}]);